@model Exam.Domain.Sports.Spot


@{
    ViewData["Title"] = "AddDoctor";

    
 
    var ResultData = ViewBag.Result as List<Exam.Domain.Sports.Spot>;
}
@*<style>
    input[type=radio]
    {
        border:0px;
        width:5%;
        height:2em;
    }
    input {
        position: relative;
        width: 339px;
        height: 37px;
        color: white;
    }

    .mystyle:before {
        position: absolute;
        top: 3px;
        left: 3px;
        content: attr(my-date);
        display: inline-block;
        color: black;
    }
</style>*@
<div class="page-title">
    <div class="title-details">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb p-0 mb-0 bg-transparent" id="navigation">
            </ol>
        </nav>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="card">
            <div class="card-header">

                <div class="indicatorslist">
                    <a title="" href="javascript:void(0)" id="backIcon" data-toggle="tooltip" data-placement="top" data-original-title="Back"><i class="icon-arrow-left1"></i></a>
                    <center><h2>Sport Registration Forms </h2></center>
                </div>
            </div>
           

            <!-- BASIC FORM ELEMENTS -->
            <!--===================================================-->
        <div class="card-body">
            <div class="form-group row">
                <label class="col-12 col-md-2 col-xl-2 control-label" for="demo-email-input">Club Name  <span class="text-danger">*</span></label>
                <div class="col-12 col-md-6 col-xl-4">
                    <select id="Club" class="form-control" onchange="GetAllSubCatByCId()" asp-items="@(new SelectList(ViewBag.UnitName,"club_id","club_name"))">
                    </select>
                </div>
            </div>
            <div class="form-group row">
                <label class="col-12 col-md-2 col-xl-2 control-label" for="demo-email-input">Sports Name  <span class="text-danger">*</span></label>
                <div class="col-12 col-md-6 col-xl-4">
                    <select id="Sports" class="form-control">
                        <option value="0">Select</option>
                    </select>
                </div>
            </div>

         
            <div class="form-group row">
                <label class="col-12 col-md-2 col-xl-2 control-label" for="demo-email-input">AppliCant Name  <span class="text-danger">*</span></label>
                <div class="col-12 col-md-6 col-xl-4">
                    <input id="NAme" class="form-control" />
                </div>

            </div>

         
            <div class="form-group row">
                <label class="col-12 col-md-2 col-xl-2 control-label" for="demo-email-input">Email  <span class="text-danger">*</span></label>
                <div class="col-12 col-md-6 col-xl-4">
                    <input id="Email" type="email" class="form-control" onchange="emailValidate('Email','lblError')" />
                    <span id="lblError" style="color:red"></span>
                </div>

            </div>

          
            <div class="form-group row">
                <label class="col-12 col-md-2 col-xl-2 control-label" for="demo-email-input">Mobile  <span class="text-danger">*</span></label>
                <div class="col-12 col-md-6 col-xl-4">
                    <input id="Mobile" class="form-control" onchange="Phonevalidate('Mobile','lblErrorPhone')" />
                    <span id="lblErrorPhone" style="color:red"></span>
                </div>
            </div>
          


         
            <div class="form-group row">
                <label class="col-12 col-md-2 col-xl-2 control-label" for="demo-email-input">Gender<span class="text-danger">*</span></label>
                <div class="col-12 col-md-4 col-xl-4">
                    <input type="radio" id="SchoolType" name="SchoolType" class="s_type " value="Male" />Male
                    @*<label for="SchoolType">Male</label>*@
                    <input type="radio" id="SchoolType" name="SchoolType" class="s_type " value="Female" />Female
                    @*<label for="SchoolType">Female</label>*@
                </div>
            </div>
        
            <div class="form-group row">
                <label class="col-12 col-md-2 col-xl-2 control-label" for="demo-email-input">Image  <span class="text-danger">*</span></label>
                <div class="col-12 col-md-6 col-xl-4">
                    <input id="Image" class="form-control" type="file" />

                </div>

            </div>

        <div class="form-group row">
                <label class="col-12 col-md-2 col-xl-2 control-label" for="demo-email-input">Dob  <span class="text-danger">*</span></label>
                <div class="col-12 col-md-6 col-xl-4">
                    <input type="date" id="db" class="form-control" />
                    @*<input type="date" id="dob" class="mystyle" my-date="" placeholder="DD/MM/YYYY" my-date-format="DD/MM/YYYY" value="2024-12-31" class="form-control">*@
                    @*<input type="text" placeholder="DD/MM/YYYY" onfocus="(this.type='date')" id="dob" class="mystyle" my-date="" my-date-format="DD/MM/YYYY" value="2015-08-09">
                    <input placeholder="DD/MM/YYYY"
                           class="textbox-n mystyle"
                           type="text"
                           onfocus="(this.type='date')"
                           id="dob" my-date-format="DD/MM/YYYY"  my-date=""/>*@
                    
                </div>
             </div>
        </div>
                <div class="form-group col-md-4">
                    <label class="control-label">Image</label>
                    <img src="" width="30" height="30" id="si" />


                </div>

          

      



      


        <div class="form-group col-md-4">

            <input id="PatientID" class="form-control" hidden />
        </div>


        <div class="form-group row">
            <label class="col-12 col-md-2 col-xl-2 control-label"></label>
            <div class="col-12 col-md-6 col-xl-4">
                <button class="btn btn-primary mb-1" id="btnSubmit">Submit</button>
                <button class="btn btn-danger mb-1" id="btnCancel">Reset</button>
            </div>
        </div>
    </div>

    <div class="card-body ">
        @if (ResultData != null && ResultData.ToList().Count > 0)
        {
        <div class="table-responsive">
            <table data-toggle="table" id="tblDoctor" class="table">
                <thead>
                    <tr>
                        <th width="60px" class="align-top text-center">Sl#</th>
                        <th width="150px" class="align-top">
                            Name
                        </th>
                        <th width="150px" class="align-top">
                            Email
                        </th>

                        <th width="150px" class="align-top">
                            Mobile
                        </th>
                        <th width="150px" class="align-top">
                            Club Name
                        </th>

                        <th width="150px" class="align-top">
                            Sports Name
                        </th>
                        <th width="150px" class="align-top">
                            Image
                        </th>




                        <th width="150px" class="align-top">Action</th>
                    </tr>
                </thead>
                <tbody>
                    @{
                        int count = 1;
                    }
                    @foreach (var list in ResultData)
                    {
                        <tr>
                            <td class="text-center">@count</td>
                            <td>
                                @list.Applicant_name
                            </td>
                            <td>
                                @list.Email
                            </td>
                            <td>
                                @list.Mobile_no
                            </td>
                            <td>
                                @list.club_name
                            </td>
                            <td>
                                @list.sprot_name
                            </td>
                            <td>
                                <img src="../@list.image_path" width="60" height="60" />
                            </td>

                            <td>
                                @*<a href="/RegistrationUser/User_Registration?id=@Convert.ToString(@list.UserId)" class="text-primary mr-3" title="" data-original-title="Edit"><i class="icon-edit1"></i></a>*@
                                @*<a onclick="updateDepartment('@list.Registration_Id', '@list.club_id');" class="text-primary mr-3" title="" data-original-title="Edit"><i class="icon-edit1"></i></a>*@
                                <button onclick="Edit('@list.Registration_Id');"> Edit</button>

                            </td>
                        </tr>
                        count++;
                    }
                </tbody>
            </table>

            <div class="form-group row">
               
                <div class="col-12 col-md-6 col-xl-4">
                    <button class="btn btn-danger mb-1" id="download">Download all Data</button>
                </div>
            </div>

           
        </div>
        }
        else
        {
            <div class="norecord"> No Record Found</div>
        }
        <div class="clearfix col-sm-12"></div>
    </div>
    <!--===================================================-->
    <!-- END BASIC FORM ELEMENTS -->
</div>

 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.3/moment.min.js"></script>

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/validation/validation.js"></script>
<script>

    $(document).ready(function () {
      
       
        
    });

    $("#download").click(function () {
        var doc = {
            Registration_Id: 1
        }
        alert("click");
        $.ajax({
            url: "/Sport/Download",
            data: doc,
            type: "GET",
            success: function (result) {
               
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
        
    });
    //function nowAsDuration() {
    //    return moment.duration({
    //        hours: moment().hour(),
    //        minutes: moment().minute(),
    //        seconds: moment().second()
    //    });
    //}


    //$(".mystyle").on("change", function () {
    //    var a = moment(this.value);
    //    var b = nowAsDuration();
    //    var c = a.add(b);
    //    this.setAttribute("my-date", c.format(this.getAttribute("my-date-format"))
    //    )
    //}).trigger("change")

    //function ChangeDateFormat() {

    //    $(".mystyle").on("change", function () {
    //        var a = moment(this.value);
    //        var b = nowAsDuration();
    //        var c = a.add(b);
    //        this.setAttribute("my-date", c.format(this.getAttribute("my-date-format"))
    //        )
    //    }).trigger("change")
    //}
  

    function GetAllSubCatByCId() {

        $.ajax({
            url: "/Sport/GetSubCatByCId?clubid=" + $('#Club').val(),
            type: "GET",
            success: function (result) {
                data = JSON.parse(result);
                var v = "<option value='0'>--Select--</option>";
                $.each(data, function (i, item) {
                    v += "<option value=" + item.Value + ">" + item.Text + "</option>";
                });
                $("#Sports").html(v);
            },
            error: function (error) {
                jsonValue = jQuery.parseJSON(error.responseText);
                bootbox.alert("Error : " + jsonValue);
            }
        });
    }

    function validate() {
          if ($('#Club').val() == "0") {
            alert("Please Select Club !");
            return false;
            $('#Club').focus();
        }

        else if ($('#Sports').val() == "0") {
            alert("Please Select Sports !");
            return false;
            $('#Sports').focus();
        }
       else if ($('#NAme').val() == "") {
            alert("Please Enter Name!");
            $('#NAme').focus();
            return false;
        }
        else if ($('#Email').val() == "") {
            alert("Please Enter Email!");
            return false;
            $('#Email').focus();
        }
        else if ($('#Mobile').val() == "") {
            alert("Please Enter Mobile");
            $('#Mobile').focus();
            return false;
          }
          else if ($('#dob').val() == "") {
              alert("Please Select dob !");
              return false;
              $('#dob').focus();
          }
        else if ($('#Gender').val() == "0") {
            alert("Please Select Gender!");
            $('#Gender').focus();
            return false;
        }
      

         
          else if ($('#Image').val() == "") {
              alert("Please Select Image !");
              return false;
              $('#Image').focus();
          }
        else
            return true;
      
       

    }
    function reset() {
        $('#PatientID').val("");
        $("#NAme").val("");
        $("#Email").val("");
        $("#Mobile").val("");
      
        $("#db").val("");
      
        $("#Gender").val("0");
        $("#Club").val("0");
        $("#Sports").val("0");
    }
    $("#btnCancel").click(function () { reset()});

    $("#btnSubmit").click(function () {

        var files = $('#Image').prop("files");


        var url = "Sport/UploadImage";
        formData = new FormData();
        formData.append("MyUploader", files[0]);
      
        jQuery.ajax({
            type: 'POST',
            url: url,
            data: formData, 
            cache: false,
            contentType: false,
            processData: false,
            beforeSend: function (xhr) {
                xhr.setRequestHeader("XSRF-Token",
                    $('input:hidden[name="__RequestVerificationToken"]').val());
            },
            success: function (repo) {
                if (repo.status == "success") {
                    //alert("File : " + repo.filename + " is uploaded successfully");
                }
            },
            error: function () {
                alert("Error occurs");
            }

        });



        var doc = {
            Registration_Id: $("#PatientID").val(),
            Applicant_name: $("#NAme").val(),
            Email: $("#Email").val(),
            Mobile_no: $("#Mobile").val(),
            image_path: $("#Image").val(),
            Gender: $(".s_type:checked").val(),
            dob: $("#db").val(),
            club_id: $("#Club").val(),
            sport_Id: $("#Sports").val(),
           

        };
        if (validate() && emailValidate('Email', 'lblError') == true && Phonevalidate('Mobile', 'lblErrorPhone') == true) {

            $.ajax({
                url: "/Sport/Add",
                data: doc,
                type: "POST",
                success: function (result) {
                    if (result == "Record Saved Successfully") {
                        alert(result)
                        window.location.href = "/Sport/Sport_Registration";
                    }
                    else if (result == "Record Update Successfully") {
                        alert(result)
                        window.location.href = "/Sport/Sport_Registration";
                    }
                    else
                        alert(result);
                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            });
        }
    });
    //UPDATE
    function Edit(id) {
       // ChangeDateFormat();
        $("#btnSubmit").html('Update')
        $.ajax({
            url: "/Sport/MedicineGetById?id=" + id,
            typr: "GET",
            contentType: "application/json;charset=UTF-8",
            dataType: "json",
            success: function (result) {
                $("#PatientID").val(id);
                $("#NAme").val(result.Applicant_name);
                $("#Email").val(result.Email);
                $("#Mobile").val(result.Mobile_no);

                $.ajax({
                    url: "/Sport/GetSubCatByCId?clubid=" + result.club_id,
                    type: "GET",
                    success: function (result1) {
                        data = JSON.parse(result1);
                        var v = "<option value='0'>--Select--</option>";
                        $.each(data, function (i, item) {
                            v += "<option value=" + item.Value + ">" + item.Text + "</option>";
                        });

                        $("#Sports").html(v);
                        $("#Sports").val(result.sport_Id);
                       
                    },
                    error: function (error) {
                        jsonValue = jQuery.parseJSON(error.responseText);
                        bootbox.alert("Error : " + jsonValue);
                    }
                });
          
                $('input[type="radio"]').each(function () {
                    if ($(this).val() == result.Gender) {
                        $(this).attr('checked', 'checked');
                    }
                });
                $("#db").val(result.dob);
             
                $("#Club").val(result.club_id);

                $("#si").attr("src","../"+result.image_path);
               
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
        return false;
    }
</script>
